# 视频上传和播放系统

这是一个基于Express.js和React的视频上传和播放系统，支持大文件分片上传和视频流式播放。

## 功能特性

- ✅ 大文件分片上传（支持断点续传）
- ✅ 视频列表展示
- ✅ 视频流式播放（支持范围请求）
- ✅ 实时上传进度显示
- ✅ 响应式UI设计

## 系统架构

### 后端 (Express.js)
- **文件上传**: 使用multer处理分片上传
- **文件合并**: 自动合并上传的分片文件
- **视频流**: 支持HTTP范围请求，实现视频流式播放
- **CORS支持**: 跨域资源共享

### 前端 (React + Vite)
- **文件选择**: 支持视频文件选择
- **分片上传**: 前端分片处理
- **进度显示**: 实时显示上传进度
- **视频播放**: 使用HTML5 video标签播放视频

## API接口

### 1. 获取视频列表
```
GET /list/api/videos
```
返回所有上传的视频文件信息

### 2. 上传文件分片
```
POST /list/api/upload-chunk?fileId={fileId}
```
上传单个文件分片

### 3. 合并文件分片
```
POST /list/api/merge-chunks
```
合并所有分片为完整文件

### 4. 获取视频流
```
GET /list/api/video/{filename}
```
获取视频文件流，支持范围请求

## 安装和运行

### 后端启动
```bash
cd express_app
npm install
npm start
```
服务器将在 http://localhost:3000 启动

### 前端启动
```bash
cd reactVite01
npm install
npm run dev
```
前端将在 http://localhost:5173 启动

## 使用说明

1. **上传视频**:
   - 点击"选择文件"按钮选择视频文件
   - 点击"上传视频"开始上传
   - 系统会自动将大文件分片上传
   - 上传完成后文件会出现在视频列表中

2. **播放视频**:
   - 在视频列表中点击任意视频
   - 视频将在下方播放器中播放
   - 支持播放控制（播放、暂停、进度条等）

3. **文件管理**:
   - 系统自动过滤视频文件（.mp4, .avi, .mov等）
   - 显示文件大小和上传时间
   - 支持视频流式播放，无需等待完整下载

## 技术细节

### 分片上传
- 分片大小: 5MB
- 支持断点续传
- 自动合并分片

### 视频流
- 支持HTTP Range请求
- 实现视频流式播放
- 减少内存占用

### 文件存储
- 文件存储在 `routes/uploads/` 目录
- 临时分片存储在 `routes/uploads/{fileId}/` 目录
- 合并完成后自动清理临时文件

## 注意事项

1. 确保服务器有足够的存储空间
2. 大文件上传可能需要较长时间
3. 建议在生产环境中添加文件大小限制
4. 可以根据需要调整分片大小

## 测试

运行测试脚本验证API功能：
```bash
cd express_app
node test-video.js
``` 